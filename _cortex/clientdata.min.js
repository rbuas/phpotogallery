ClientData=function($,tracer){function ClientData(options){function unload(){self.options.readonly||(tracer.message("ClientData::onunload",self),self.save())}var defaults={readonly:!1,initialData:{}};this.options=$.extend({},defaults,options),ClientStorage.call(this,this.options),this.load();var self=this;window.addEventListener?window.addEventListener("unload",unload,!1):window.attachEvent?window.attachEvent("onunload",unload):window.onunload=unload}return ClientData.prototype=$.extend({},ClientStorage.prototype,{addDataSourceListener:function(key,dataCallback){var self=this;if(key&&dataCallback){var listener=function(){var filteredModel=dataCallback();self.set(key,filteredModel),self.save()};window.addEventListener?window.addEventListener("unload",listener,!1):window.attachEvent?window.attachEvent("onunload",listener):window.onunload=listener}}}),ClientData.prototype.constructor=ClientData,ClientData}(jQuery,tracer);